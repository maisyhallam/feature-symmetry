theme(legend.position = 'none')
?expression
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none')
9
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=1.9, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none')
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none')
ggsave('../plots/small_sample_grid.png',width = 5,height = 5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 1)
?aspect.ratio
?theme
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 1)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 1.5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=2, y=6, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4) +
geom_richtext(data=z_labels, mapping=aes(x=1.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
?geom_vline
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4, linesize = 1) +
geom_richtext(data=z_labels, mapping=aes(x=1.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 4, size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=1.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
geom_vline(aes(xintercept = real_value),linetype = 'dashed;, size = 1) +
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=1.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=1.8, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=1.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=1, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=0.5, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x=0.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
z_labels <-
z_labels <- tibble(
language = filter(z, language %in% c('English', 'Hindi', 'Sundanese', 'Warlpiri'))$language,
z = filter(z, language %in% c('English', 'Hindi', 'Sundanese', 'Warlpiri'))$zscore,
x = c(1.7, 1.6, 0.65,0.65)
)
z_labels <-
z_labels <- tibble(
language = filter(z, language %in% c('English', 'Hindi', 'Sundanese', 'Warlpiri'))$language,
z = filter(z, language %in% c('English', 'Hindi', 'Sundanese', 'Warlpiri'))$zscore,
x = c(1.7, 1.6, 0.65,0.65, 0.65)
)
z_labels <- z_labels %>% filter(!row_number() %in% c(4))
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed', size = 1) +
geom_richtext(data=z_labels, mapping=aes(x= x, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
ggsave('../plots/small_sample_grid.png',width = 5,height = 5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed') +
geom_richtext(data=z_labels, mapping=aes(x= x, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
ggsave('../plots/small_sample_grid.png',width = 5,height = 5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed') +
geom_richtext(data=z_labels, mapping=aes(x= 0.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed') +
geom_richtext(data=z_labels, mapping=aes(x= 1.7, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed') +
geom_richtext(data=z_labels, mapping=aes(x= 1.6, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
ggsave('../plots/small_sample_grid.png',width = 5,height = 5)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed') +
geom_richtext(data=z_labels, mapping=aes(x= 1.6, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)',
y = 'density') +
theme_bw(base_size = 18) +
theme(legend.position = 'none',
aspect.ratio = 0.75)
sample2 %>%
ggplot(aes(x = simulated_value, fill = language,colour = language)) +
scale_fill_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
scale_colour_manual(values = c('#d95f50','#7570b3','#1b9e77','#ffeda0')) +
geom_density() +
geom_vline(aes(xintercept = real_value),linetype = 'dashed') +
geom_richtext(data=z_labels, mapping=aes(x= 1.6, y=8, label=paste0('<i>z = </i>', round(z,2))), inherit.aes = FALSE) +
facet_wrap(~language) +
labs(x = 'Mutual information (bits)',
y = 'density') +
theme_bw(base_size = 18) +
theme(legend.position = 'none')
ggsave('../plots/small_sample_grid.png',width = 5,height = 5)
sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
ggplot(aes(x = language_family, y = z)) +
geom_jitter(aes(colour = language_family),alpha = 0.2,height = 0.1, width = 0.1) +
geom_hline(yintercept = 1.96, linetype = 'dashed') +
geom_hline(yintercept = -1.96, linetype = 'dashed') +
theme(legend.position = 'none')
sims <- read_csv('data/processed/kinbank_sims_combined.csv')
sims <- read_csv('../data/processed/kinbank_sims_combined.csv')
sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
ggplot(aes(x = language_family, y = z)) +
geom_jitter(aes(colour = language_family),alpha = 0.2,height = 0.1, width = 0.1) +
geom_hline(yintercept = 1.96, linetype = 'dashed') +
geom_hline(yintercept = -1.96, linetype = 'dashed') +
theme(legend.position = 'none')
sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique()
sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
sum(z > 1.96)
sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
summarise(
n = sum(z > 1.96)
)
by_language_z <- sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique()
sum(by_language_z, z>1.96)
sum(by_language_z$z>1.96)
by_language_z <- sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
omit.na()
by_language_z <- sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
na.omit()
sum(by_language_z$z>1.96)
length(filter(sims,simulated_value > 0))
length(filter(sims,simulated_value < 0))
length(filter(sims,simulated_value > 0))
filter(sims,simulated_value > 0)
count(filter(sims,simulated_value > 0))
count(filter(sims,simulated_value > 0)) %>% unique()
count(unique(filter(sims,simulated_value > 0)))
by_language_z <- sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
na.omit() %>%
count()
by_language_z <- sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
na.omit() %>%
summary()
by_language_z <- sims %>% filter(simulated_value > 0) %>%
group_by(language,language_family) %>%
summarise(
mean = mean(simulated_value),
sd = sd(simulated_value),
real_value = real_value,
extreme = sum(real_value <= simulated_value),
denom = n(),
z = (real_value - mean) / sd,
p_language = extreme/denom
) %>%
unique() %>%
na.omit()
by_language_z
sum(by_language_z$z>1.96)
length(by_language_z)
count(by_language_z)
by_language_z
sum(by_language_z$z>1.96)/544
table(sims$language_family)
library(brms)
